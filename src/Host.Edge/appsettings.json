{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information",
      "IntelliMaint": "Debug"
    }
  },
  
  "Edge": {
    "EdgeId": "edge-001",
    "DatabasePath": "data/intellimaint.db",
    "QueueCapacityGlobal": 200000,
    "WriterBatchSize": 500,
    "WriterFlushMs": 200,
    "Overflow": {
      "Enabled": true,
      "Directory": "data/overflow",
      "RollSizeMB": 100,
      "Compress": true,
      "RetentionDays": 7
    },
    "Health": {
      "SnapshotIntervalSec": 30,
      "MemoryWarnMB": 500,
      "MemoryAlarmMB": 1000,
      "WriteLatencyWarnMs": 100,
      "DropRateWarnPerMinute": 1000
    }
  },
  
  "ConfigWatcher": {
    "Enabled": true,
    "IntervalMs": 1000
  },
  
  "ChannelCapacity": {
    "LibPlcTagCapacity": 100000,
    "OpcUaCapacity": 50000,
    "ModbusCapacity": 10000,
    "OpcDaCapacity": 10000,
    "GlobalCapacity": 200000,
    "DbWriterCapacity": 50000,
    "MqttPublisherCapacity": 50000,
    "AlarmProcessorCapacity": 10000
  },
  
  "Protocols": {
    "LibPlcTag": {
      "Enabled": true,
      "SimulationMode": true,
      "Plcs": [
        {
          "PlcId": "SIM-PLC-001",
          "IpAddress": "127.0.0.1",
          "Path": "1,0",
          "Slot": 0,
          "PlcType": "ControlLogix",
          "MaxConnections": 4,
          "ReadMode": "BatchRead",
          "TimeoutMs": 5000,
          "Retry": {
            "MaxRetries": 3,
            "InitialDelayMs": 1000,
            "MaxDelayMs": 60000,
            "BackoffMultiplier": 2.0
          },
          "TagGroups": [
            {
              "Name": "Fast",
              "ScanIntervalMs": 100,
              "BatchReadSize": 50,
              "Tags": [
                {
                  "TagId": "Motor1_Speed",
                  "Name": "Program:MainProgram.Motor1.Speed",
                  "CipType": "REAL",
                  "Unit": "RPM",
                  "Description": "电机1转速"
                },
                {
                  "TagId": "Motor1_Current",
                  "Name": "Program:MainProgram.Motor1.Current",
                  "CipType": "REAL",
                  "Unit": "A",
                  "Description": "电机1电流"
                },
                {
                  "TagId": "Motor1_Temp",
                  "Name": "Program:MainProgram.Motor1.Temperature",
                  "CipType": "REAL",
                  "Unit": "°C",
                  "Description": "电机1温度"
                },
                {
                  "TagId": "Motor1_Running",
                  "Name": "Program:MainProgram.Motor1.Running",
                  "CipType": "BOOL",
                  "Description": "电机1运行状态"
                }
              ]
            },
            {
              "Name": "Normal",
              "ScanIntervalMs": 1000,
              "BatchReadSize": 100,
              "Tags": [
                {
                  "TagId": "Tank1_Level",
                  "Name": "Program:MainProgram.Tank1.Level",
                  "CipType": "REAL",
                  "Unit": "%",
                  "Description": "储罐1液位"
                },
                {
                  "TagId": "Tank1_Pressure",
                  "Name": "Program:MainProgram.Tank1.Pressure",
                  "CipType": "REAL",
                  "Unit": "bar",
                  "Description": "储罐1压力"
                },
                {
                  "TagId": "Tank1_Flow",
                  "Name": "Program:MainProgram.Tank1.Flow",
                  "CipType": "REAL",
                  "Unit": "m³/h",
                  "Description": "储罐1流量"
                },
                {
                  "TagId": "Production_Count",
                  "Name": "Program:MainProgram.Production.TotalCount",
                  "CipType": "DINT",
                  "Unit": "pcs",
                  "Description": "生产计数"
                }
              ]
            },
            {
              "Name": "Slow",
              "ScanIntervalMs": 5000,
              "BatchReadSize": 50,
              "Tags": [
                {
                  "TagId": "Setpoint_Temp",
                  "Name": "Program:MainProgram.Setpoint.Temperature",
                  "CipType": "REAL",
                  "Unit": "°C",
                  "Description": "温度设定值"
                },
                {
                  "TagId": "Ramp_Value",
                  "Name": "Program:MainProgram.Test.RampValue",
                  "CipType": "REAL",
                  "Description": "斜坡测试值"
                }
              ]
            }
          ]
        }
      ]
    },
    "OpcUa": {
      "Enabled": false,
      "Endpoints": []
    },
    "Modbus": {
      "Enabled": false,
      "Slaves": []
    },
    "OpcDa": {
      "Enabled": false,
      "Servers": []
    }
  },
  
  "Mqtt": {
    "Enabled": false,
    "Broker": "tcp://localhost:1883",
    "ClientId": "edge-001",
    "Username": null,
    "Password": null,
    "CleanSession": false,
    "KeepAliveSec": 30,
    "Qos": {
      "Telemetry": 0,
      "Alarm": 1,
      "Health": 1
    },
    "Publish": {
      "Mode": "Batch",
      "BatchIntervalMs": 500,
      "Deadband": {
        "Float": 0.01,
        "Double": 0.01
      },
      "ForcePublishIntervalMs": 60000
    },
    "Outbox": {
      "Enabled": true,
      "MaxQueueItems": 200000,
      "DrainBatchSize": 100,
      "DrainIntervalMs": 100
    },
    "TopicPrefix": "intellimaint/v1"
  }
}
