{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information",
      "IntelliMaint": "Debug"
    }
  },
  "ConnectionStrings": {
    "TimescaleDb": "Host=localhost;Port=5432;Database=intellimaint;Username=intellimaint;Password=IntelliMaint2024!"
  },
  "Edge": {
    "EdgeId": "edge-001",
    "ApiBaseUrl": "http://localhost:5001",
    "ConfigSyncIntervalMs": 30000,
    "QueueCapacityGlobal": 200000,
    "WriterBatchSize": 1000,
    "WriterFlushMs": 500,
    "WriterMaxRetries": 3,
    "WriterRetryDelayMs": 1000,
    "Overflow": {
      "Enabled": true,
      "Directory": "data/overflow",
      "RollSizeMB": 100,
      "Compress": true,
      "RetentionDays": 7
    },
    "Health": {
      "SnapshotIntervalSec": 30,
      "MemoryWarnMB": 500,
      "MemoryAlarmMB": 1000,
      "WriteLatencyWarnMs": 100,
      "DropRateWarnPerMinute": 1000
    }
  },
  "StoreForward": {
    "Enabled": true,
    "MaxStoreSizeMB": 1000,
    "RetentionDays": 7,
    "CompressionEnabled": true,
    "CompressionAlgorithm": "Gzip"
  },
  "ConfigWatcher": {
    "Enabled": true,
    "IntervalMs": 1000
  },
  "ChannelCapacity": {
    "LibPlcTagCapacity": 100000,
    "OpcUaCapacity": 50000,
    "ModbusCapacity": 10000,
    "OpcDaCapacity": 10000,
    "GlobalCapacity": 200000,
    "DbWriterCapacity": 50000,
    "MqttPublisherCapacity": 50000,
    "AlarmProcessorCapacity": 10000
  },
  "Protocols": {
    "LibPlcTag": {
      "Enabled": true,
      "SimulationMode": true,
      "Plcs": [
        {
          "PlcId": "Motor-001",
          "IpAddress": "127.0.0.1",
          "Path": "1,0",
          "Slot": 0,
          "PlcType": "ControlLogix",
          "MaxConnections": 4,
          "ReadMode": "BatchRead",
          "TimeoutMs": 5000,
          "Retry": {
            "MaxRetries": 3,
            "InitialDelayMs": 1000,
            "MaxDelayMs": 60000,
            "BackoffMultiplier": 2.0
          },
          "TagGroups": [
            {
              "Name": "MotorData",
              "ScanIntervalMs": 500,
              "BatchReadSize": 10,
              "Tags": [
                {
                  "TagId": "Current",
                  "Name": "Program:MainProgram.Motor.Current",
                  "CipType": "REAL",
                  "Unit": "A",
                  "Description": "电机电流"
                },
                {
                  "TagId": "Voltage",
                  "Name": "Program:MainProgram.Motor.Voltage",
                  "CipType": "REAL",
                  "Unit": "V",
                  "Description": "电机电压"
                },
                {
                  "TagId": "Torque",
                  "Name": "Program:MainProgram.Motor.Torque",
                  "CipType": "REAL",
                  "Unit": "Nm",
                  "Description": "电机扭矩"
                },
                {
                  "TagId": "Running",
                  "Name": "Program:MainProgram.Motor.Running",
                  "CipType": "BOOL",
                  "Description": "电机运行状态"
                }
              ]
            }
          ]
        },
        {
          "PlcId": "SIM-PLC-001",
          "IpAddress": "127.0.0.1",
          "Path": "1,0",
          "Slot": 0,
          "PlcType": "ControlLogix",
          "MaxConnections": 4,
          "ReadMode": "BatchRead",
          "TimeoutMs": 5000,
          "Retry": {
            "MaxRetries": 3,
            "InitialDelayMs": 1000,
            "MaxDelayMs": 60000,
            "BackoffMultiplier": 2.0
          },
          "TagGroups": [
            {
              "Name": "MotorData",
              "ScanIntervalMs": 1000,
              "BatchReadSize": 10,
              "Tags": [
                {
                  "TagId": "Motor1_Speed",
                  "Name": "Program:MainProgram.Motor1.Speed",
                  "CipType": "REAL",
                  "Unit": "RPM",
                  "Description": "转速"
                },
                {
                  "TagId": "Motor1_Current",
                  "Name": "Program:MainProgram.Motor1.Current",
                  "CipType": "REAL",
                  "Unit": "A",
                  "Description": "电流"
                },
                {
                  "TagId": "Motor1_Temp",
                  "Name": "Program:MainProgram.Motor1.Temp",
                  "CipType": "REAL",
                  "Unit": "°C",
                  "Description": "温度"
                },
                {
                  "TagId": "Motor1_Running",
                  "Name": "Program:MainProgram.Motor1.Running",
                  "CipType": "BOOL",
                  "Description": "运行"
                }
              ]
            }
          ]
        }
      ]
    },
    "OpcUa": {
      "Enabled": false,
      "Endpoints": []
    },
    "Modbus": {
      "Enabled": false,
      "Slaves": []
    },
    "OpcDa": {
      "Enabled": false,
      "Servers": []
    }
  },
  "Mqtt": {
    "Enabled": false,
    "Broker": "tcp://localhost:1883",
    "ClientId": "edge-001",
    "Username": null,
    "Password": null,
    "CleanSession": false,
    "KeepAliveSec": 30,
    "Qos": {
      "Telemetry": 0,
      "Alarm": 1,
      "Health": 1
    },
    "Publish": {
      "Mode": "Batch",
      "BatchIntervalMs": 500,
      "Deadband": {
        "Float": 0.01,
        "Double": 0.01
      },
      "ForcePublishIntervalMs": 60000
    },
    "Outbox": {
      "Enabled": true,
      "MaxQueueItems": 200000,
      "DrainBatchSize": 100,
      "DrainIntervalMs": 100
    },
    "TopicPrefix": "intellimaint/v1"
  }
}
