---
name: review
description: 执行完整的代码审查流程，检查代码质量、安全性、性能
---

# 代码审查任务

请按照以下步骤执行完整的代码审查：

## 1. 审查范围确定

询问用户要审查的范围：
- 特定文件/目录
- 最近的变更
- 全项目审查

如果用户没有指定，默认审查核心模块：
- `src/Host.Api/Endpoints/`
- `src/Infrastructure/Sqlite/`
- `src/Application/Services/`

## 2. 正确性审查 (40%)

使用 `code-reviewer` 的检查清单：

### C# 代码
- [ ] 逻辑正确性
- [ ] 边界条件处理（null、空集合、边界值）
- [ ] 异常处理完整性
- [ ] 资源正确释放（IDisposable）
- [ ] 并发安全性

### React 代码
- [ ] 组件行为正确
- [ ] 状态管理正确
- [ ] 事件处理正确
- [ ] 错误边界处理

## 3. 安全性审查 (25%)

使用 `security-expert` 的检查清单：

- [ ] SQL 参数化查询
- [ ] 用户输入验证
- [ ] 敏感信息不硬编码
- [ ] 权限检查到位
- [ ] 日志不含敏感信息

## 4. 性能审查 (15%)

使用 `performance-expert` 的检查清单：

- [ ] 无同步阻塞调用
- [ ] 使用 CancellationToken
- [ ] 避免 N+1 查询
- [ ] 合理使用缓存
- [ ] 大集合使用分页

## 5. 可维护性审查 (15%)

- [ ] 命名清晰有意义
- [ ] 方法不超过 30 行
- [ ] 类职责单一
- [ ] 有必要的注释
- [ ] 无重复代码

## 6. 一致性审查 (5%)

- [ ] 符合项目命名规范
- [ ] 符合项目代码风格
- [ ] 符合项目架构规范

## 7. 生成审查报告

按以下格式生成报告：

```markdown
# 代码审查报告

## 概要
- **审查范围**: xxx
- **审查日期**: xxx
- **整体评级**: ⭐⭐⭐⭐ (4/5)

## 发现问题

### 🔴 Critical (必须修复)
1. [文件:行号] 问题描述
   - 原因: xxx
   - 建议: xxx

### 🟡 Warning (建议修复)
...

### 🟢 Info (可选优化)
...

## 亮点
- ✅ xxx
- ✅ xxx

## 总结
xxx
```

---

**注意事项**：
- 客观公正，基于事实
- 提供具体的改进建议
- 肯定优秀的代码实践
- Critical 问题必须修复后才能通过
